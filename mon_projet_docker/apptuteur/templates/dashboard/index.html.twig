{% extends 'base.html.twig' %}

{% block title %}Tableau de bord
{% endblock %}

{% block body %}
	<h1 class="mb-3">Bienvenue
		{{ tuteur.prenom }}
		{{ tuteur.nom }}</h1>

	<div class="row g-3 mb-4">
		<div class="col-md-6">
			<div class="card shadow-sm h-100">
				<div class="card-body">
					<h2 class="h5">Vos informations</h2>
					<p class="mb-1">
						<strong>Email :</strong>
						{{ tuteur.email }}</p>
					<p class="mb-1">
						<strong>Téléphone :</strong>
						{{ tuteur.telephone }}</p>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="card shadow-sm h-100">
				<div class="card-body d-flex flex-column">
					<div class="d-flex justify-content-between align-items-center mb-2">
						<h2 class="h5 mb-0">Étudiants suivis</h2>
						<a class="btn btn-sm btn-primary" href="{{ path('etudiants_new') }}">Ajouter</a>
					</div>
					<ul class="list-group flex-grow-1">
						{% for etu in etudiants %}
							<li class="list-group-item d-flex justify-content-between align-items-center">
								<span>{{ etu.prenom }}
									{{ etu.nom }}
									—
									{{ etu.formation }}</span>
								<a class="btn btn-outline-primary btn-sm" href="{{ path('etudiant_visites', {id: etu.id}) }}">Visites</a>
							</li>
						{% else %}
							<li class="list-group-item">Aucun étudiant.</li>
						{% endfor %}
					</ul>
				</div>
			</div>
		</div>
	</div>

	<div class="card shadow-sm">
		<div class="card-body">
			<div class="d-flex justify-content-between align-items-center mb-2">
				<h2 class="h5 mb-0">Prochaines visites</h2>
				<a class="btn btn-sm btn-outline-secondary" href="{{ path('etudiants_index') }}">Voir tout</a>
			</div>
			<div class="table-responsive">
				<table class="table table-striped align-middle">
					<thead>
						<tr>
							<th>Date</th>
							<th>Étudiant</th>
							<th>Statut</th>
							<th>Commentaire</th>
						</tr>
					</thead>
					<tbody>
						{% for visite in visites %}
							<tr>
								<td>{{ visite.date|date('d/m/Y H:i') }}</td>
								<td>{{ visite.etudiant.prenom }}
									{{ visite.etudiant.nom }}</td>
								<td>
									<span class="badge bg-info">{{ visite.statut|capitalize }}</span>
								</td>
								<td>{{ visite.commentaire }}</td>
							</tr>
						{% else %}
							<tr>
								<td colspan="4">Aucune visite planifiée.</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock %}
